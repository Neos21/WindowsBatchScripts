# 起動を速くしたり動作を軽くしたりするための研究資料

2018-12-21 : Git For Windows の起動も速くしたい


## 事前確認

- `C:\Program Files\Git\` に v2.20.1 をインストール後、1回以上普通に起動した状態から調査・改良を開始した


## 調査

- `/etc/profile` の内容は Git SDK のモノと全く同一だったので、`$MSYSTEM` が `'MSYS'` ではなく `'MINGW64'` であることによる違い程度と推測
- 念のため全体の動きを調べ直し、設定する環境変数の違いなどをまとめた


## 作業経過

- `profile　v0 元ファイル`
  - インストール直後の `/etc/profile` そのまま
- `profile　v1 外部ファイルをインライン化・不要箇所をコメントアウト`
  - `source` しているファイルの中身をインラインにコピペした
  - 条件分岐や変数の設定内容などを細かく見ていき、余計な処理をコメントアウトした
  - 調査時のコメントも記してあるので、問題があった時はこのファイルを基に原因調査できる
- `profile　v2 コメントアウトを除去・完成版`
  - `v1` ファイルのコメントアウトを除去してファイルサイズを小さくした
  - `PATH` など複数回設定されていた変数を1回で設定するようにした
  - `export` コマンドの実行を1回にまとめ、中身が空の変数は `export` しないようにした
  - `C:\Program Files\Git\etc\profile` = `/etc/profile` のファイルの内容をこのファイルの内容に差し替えてしまえば高速化できる


## 高速化結果

厳密な計測は今回省いたが、Git SDK の時と同程度の速度に向上した。
